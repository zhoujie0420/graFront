{"ast":null,"code":"import ReconnectingWebSocket from \"reconnecting-websocket\";\nimport networkConfiguration from \"@/network/configuration\";\nimport useFriendStore from \"@/store/friend\";\nimport { showToast } from \"vant\";\nexport default function initializeWebsocket(username) {\n  let friendStore = useFriendStore();\n  let {\n    host,\n    port,\n    path\n  } = {\n    ...networkConfiguration.server.webSocketServer\n  };\n  console.log(\"username\" + username);\n  let connection = new ReconnectingWebSocket(`ws://${host}:${port}${path}/${username}`);\n  console.log(\"1111111\" + connection.url);\n  connection.onmessage = event => {\n    let message = JSON.parse(event.data);\n    friendStore.onlineList = message;\n    console.log(\"webSocketConnection.onmessage:\", message);\n  };\n  connection.onclose = event => {\n    console.log(\"webSocketConnection.onclose:\", event);\n    showToast(\"network connection closed\");\n  };\n  connection.onerror = event => {\n    console.log(\"webSocketConnection.onerror:\", event);\n    showToast(\"network connection error\");\n  };\n  connection.onopen = event => {\n    console.log(\"webSocketConnection.onopen:\", event);\n  };\n}","map":{"version":3,"names":["ReconnectingWebSocket","networkConfiguration","useFriendStore","showToast","initializeWebsocket","username","friendStore","host","port","path","server","webSocketServer","console","log","connection","url","onmessage","event","message","JSON","parse","data","onlineList","onclose","onerror","onopen"],"sources":["/Users/jiezhou/IdeaProjects/graduationPro/web/src/plugins/initialize-websocket/index.js"],"sourcesContent":["import ReconnectingWebSocket from \"reconnecting-websocket\";\nimport networkConfiguration from \"@/network/configuration\";\nimport useFriendStore from \"@/store/friend\";\nimport {showToast} from \"vant\";\n\nexport default function initializeWebsocket (username) {\n    let friendStore = useFriendStore();\n\n    let {host, port, path} = {...networkConfiguration.server.webSocketServer};\n    console.log(\"username\" + username)\n    let connection = new ReconnectingWebSocket(`ws://${host}:${port}${path}/${username}`);\n    console.log(\"1111111\" + connection.url);\n    connection.onmessage = event => {\n        let message = JSON.parse(event.data);\n        friendStore.onlineList = message;\n        console.log(\"webSocketConnection.onmessage:\", message);\n    };\n\n    connection.onclose = event => {\n        console.log(\"webSocketConnection.onclose:\", event);\n        showToast(\"network connection closed\");\n    };\n\n    connection.onerror = event => {\n        console.log(\"webSocketConnection.onerror:\", event);\n        showToast(\"network connection error\");\n    };\n\n    connection.onopen = event => {\n        console.log(\"webSocketConnection.onopen:\", event);\n    };\n}"],"mappings":"AAAA,OAAOA,qBAAqB,MAAM,wBAAwB;AAC1D,OAAOC,oBAAoB,MAAM,yBAAyB;AAC1D,OAAOC,cAAc,MAAM,gBAAgB;AAC3C,SAAQC,SAAS,QAAO,MAAM;AAE9B,eAAe,SAASC,mBAAmBA,CAAEC,QAAQ,EAAE;EACnD,IAAIC,WAAW,GAAGJ,cAAc,CAAC,CAAC;EAElC,IAAI;IAACK,IAAI;IAAEC,IAAI;IAAEC;EAAI,CAAC,GAAG;IAAC,GAAGR,oBAAoB,CAACS,MAAM,CAACC;EAAe,CAAC;EACzEC,OAAO,CAACC,GAAG,CAAC,UAAU,GAAGR,QAAQ,CAAC;EAClC,IAAIS,UAAU,GAAG,IAAId,qBAAqB,CAAE,QAAOO,IAAK,IAAGC,IAAK,GAAEC,IAAK,IAAGJ,QAAS,EAAC,CAAC;EACrFO,OAAO,CAACC,GAAG,CAAC,SAAS,GAAGC,UAAU,CAACC,GAAG,CAAC;EACvCD,UAAU,CAACE,SAAS,GAAGC,KAAK,IAAI;IAC5B,IAAIC,OAAO,GAAGC,IAAI,CAACC,KAAK,CAACH,KAAK,CAACI,IAAI,CAAC;IACpCf,WAAW,CAACgB,UAAU,GAAGJ,OAAO;IAChCN,OAAO,CAACC,GAAG,CAAC,gCAAgC,EAAEK,OAAO,CAAC;EAC1D,CAAC;EAEDJ,UAAU,CAACS,OAAO,GAAGN,KAAK,IAAI;IAC1BL,OAAO,CAACC,GAAG,CAAC,8BAA8B,EAAEI,KAAK,CAAC;IAClDd,SAAS,CAAC,2BAA2B,CAAC;EAC1C,CAAC;EAEDW,UAAU,CAACU,OAAO,GAAGP,KAAK,IAAI;IAC1BL,OAAO,CAACC,GAAG,CAAC,8BAA8B,EAAEI,KAAK,CAAC;IAClDd,SAAS,CAAC,0BAA0B,CAAC;EACzC,CAAC;EAEDW,UAAU,CAACW,MAAM,GAAGR,KAAK,IAAI;IACzBL,OAAO,CAACC,GAAG,CAAC,6BAA6B,EAAEI,KAAK,CAAC;EACrD,CAAC;AACL"},"metadata":{},"sourceType":"module","externalDependencies":[]}