{"ast":null,"code":"import { createVNode as _createVNode } from \"vue\";\nimport { computed, defineComponent, ref, watch } from \"vue\";\nimport { addUnit, closest, createNamespace, makeArrayProp, makeNumericProp, truthProp, windowHeight } from \"../utils/index.mjs\";\nimport { useEventListener } from \"@vant/use\";\nimport { useLockScroll } from \"../composables/use-lock-scroll.mjs\";\nimport { useTouch } from \"../composables/use-touch.mjs\";\nimport { useSyncPropRef } from \"../composables/use-sync-prop-ref.mjs\";\nconst floatingPanelProps = {\n  height: makeNumericProp(0),\n  anchors: makeArrayProp(),\n  duration: makeNumericProp(0.2),\n  contentDraggable: truthProp,\n  lockScroll: truthProp,\n  safeAreaInsetBottom: truthProp\n};\nconst [name, bem] = createNamespace(\"floating-panel\");\nconst DAMP = 0.2;\nvar stdin_default = defineComponent({\n  name,\n  props: floatingPanelProps,\n  emits: [\"heightChange\", \"update:height\"],\n  setup(props, {\n    emit,\n    slots\n  }) {\n    const rootRef = ref();\n    const contentRef = ref();\n    const height = useSyncPropRef(() => +props.height, value => emit(\"update:height\", value));\n    const boundary = computed(() => {\n      var _a, _b;\n      return {\n        min: (_a = props.anchors[0]) != null ? _a : 100,\n        max: (_b = props.anchors[props.anchors.length - 1]) != null ? _b : Math.round(windowHeight.value * 0.6)\n      };\n    });\n    const anchors = computed(() => props.anchors.length >= 2 ? props.anchors : [boundary.value.min, boundary.value.max]);\n    const dragging = ref(false);\n    const rootStyle = computed(() => ({\n      height: addUnit(boundary.value.max),\n      transform: `translateY(calc(100% + ${addUnit(-height.value)}))`,\n      transition: !dragging.value ? `transform ${props.duration}s` : \"none\"\n    }));\n    const ease = moveY => {\n      const absDistance = Math.abs(moveY);\n      const {\n        min,\n        max\n      } = boundary.value;\n      if (absDistance > max) {\n        return -(max + (absDistance - max) * DAMP);\n      }\n      if (absDistance < min) {\n        return -(min - (min - absDistance) * DAMP);\n      }\n      return moveY;\n    };\n    let startY;\n    const touch = useTouch();\n    const onTouchstart = e => {\n      touch.start(e);\n      dragging.value = true;\n      startY = -height.value;\n    };\n    const onTouchmove = e => {\n      var _a;\n      touch.move(e);\n      const target = e.target;\n      if (contentRef.value === target || ((_a = contentRef.value) == null ? void 0 : _a.contains(target))) {\n        if (!props.contentDraggable) return;\n        if (-startY < boundary.value.max) {\n          if (e.cancelable) e.preventDefault();\n          e.stopPropagation();\n        } else if (!(contentRef.value.scrollTop <= 0 && touch.deltaY.value > 0)) {\n          return;\n        }\n      }\n      const moveY = touch.deltaY.value + startY;\n      height.value = -ease(moveY);\n    };\n    const onTouchend = () => {\n      dragging.value = false;\n      height.value = closest(anchors.value, height.value);\n      if (height.value !== -startY) {\n        emit(\"heightChange\", {\n          height: height.value\n        });\n      }\n    };\n    watch(boundary, () => {\n      height.value = closest(anchors.value, height.value);\n    }, {\n      immediate: true\n    });\n    useLockScroll(rootRef, () => props.lockScroll);\n    useEventListener(\"touchmove\", onTouchmove, {\n      target: rootRef\n    });\n    return () => {\n      var _a;\n      return _createVNode(\"div\", {\n        \"class\": [bem(), {\n          \"van-safe-area-bottom\": props.safeAreaInsetBottom\n        }],\n        \"ref\": rootRef,\n        \"style\": rootStyle.value,\n        \"onTouchstartPassive\": onTouchstart,\n        \"onTouchend\": onTouchend,\n        \"onTouchcancel\": onTouchend\n      }, [_createVNode(\"div\", {\n        \"class\": bem(\"header\")\n      }, [_createVNode(\"div\", {\n        \"class\": bem(\"header-bar\")\n      }, null)]), _createVNode(\"div\", {\n        \"class\": bem(\"content\"),\n        \"ref\": contentRef\n      }, [(_a = slots.default) == null ? void 0 : _a.call(slots)])]);\n    };\n  }\n});\nexport { stdin_default as default, floatingPanelProps };","map":{"version":3,"names":["createVNode","_createVNode","computed","defineComponent","ref","watch","addUnit","closest","createNamespace","makeArrayProp","makeNumericProp","truthProp","windowHeight","useEventListener","useLockScroll","useTouch","useSyncPropRef","floatingPanelProps","height","anchors","duration","contentDraggable","lockScroll","safeAreaInsetBottom","name","bem","DAMP","stdin_default","props","emits","setup","emit","slots","rootRef","contentRef","value","boundary","_a","_b","min","max","length","Math","round","dragging","rootStyle","transform","transition","ease","moveY","absDistance","abs","startY","touch","onTouchstart","e","start","onTouchmove","move","target","contains","cancelable","preventDefault","stopPropagation","scrollTop","deltaY","onTouchend","immediate","default","call"],"sources":["/Users/jiezhou/IdeaProjects/web/node_modules/vant/es/floating-panel/FloatingPanel.mjs"],"sourcesContent":["import { createVNode as _createVNode } from \"vue\";\nimport { computed, defineComponent, ref, watch } from \"vue\";\nimport { addUnit, closest, createNamespace, makeArrayProp, makeNumericProp, truthProp, windowHeight } from \"../utils/index.mjs\";\nimport { useEventListener } from \"@vant/use\";\nimport { useLockScroll } from \"../composables/use-lock-scroll.mjs\";\nimport { useTouch } from \"../composables/use-touch.mjs\";\nimport { useSyncPropRef } from \"../composables/use-sync-prop-ref.mjs\";\nconst floatingPanelProps = {\n  height: makeNumericProp(0),\n  anchors: makeArrayProp(),\n  duration: makeNumericProp(0.2),\n  contentDraggable: truthProp,\n  lockScroll: truthProp,\n  safeAreaInsetBottom: truthProp\n};\nconst [name, bem] = createNamespace(\"floating-panel\");\nconst DAMP = 0.2;\nvar stdin_default = defineComponent({\n  name,\n  props: floatingPanelProps,\n  emits: [\"heightChange\", \"update:height\"],\n  setup(props, {\n    emit,\n    slots\n  }) {\n    const rootRef = ref();\n    const contentRef = ref();\n    const height = useSyncPropRef(() => +props.height, (value) => emit(\"update:height\", value));\n    const boundary = computed(() => {\n      var _a, _b;\n      return {\n        min: (_a = props.anchors[0]) != null ? _a : 100,\n        max: (_b = props.anchors[props.anchors.length - 1]) != null ? _b : Math.round(windowHeight.value * 0.6)\n      };\n    });\n    const anchors = computed(() => props.anchors.length >= 2 ? props.anchors : [boundary.value.min, boundary.value.max]);\n    const dragging = ref(false);\n    const rootStyle = computed(() => ({\n      height: addUnit(boundary.value.max),\n      transform: `translateY(calc(100% + ${addUnit(-height.value)}))`,\n      transition: !dragging.value ? `transform ${props.duration}s` : \"none\"\n    }));\n    const ease = (moveY) => {\n      const absDistance = Math.abs(moveY);\n      const {\n        min,\n        max\n      } = boundary.value;\n      if (absDistance > max) {\n        return -(max + (absDistance - max) * DAMP);\n      }\n      if (absDistance < min) {\n        return -(min - (min - absDistance) * DAMP);\n      }\n      return moveY;\n    };\n    let startY;\n    const touch = useTouch();\n    const onTouchstart = (e) => {\n      touch.start(e);\n      dragging.value = true;\n      startY = -height.value;\n    };\n    const onTouchmove = (e) => {\n      var _a;\n      touch.move(e);\n      const target = e.target;\n      if (contentRef.value === target || ((_a = contentRef.value) == null ? void 0 : _a.contains(target))) {\n        if (!props.contentDraggable)\n          return;\n        if (-startY < boundary.value.max) {\n          if (e.cancelable)\n            e.preventDefault();\n          e.stopPropagation();\n        } else if (!(contentRef.value.scrollTop <= 0 && touch.deltaY.value > 0)) {\n          return;\n        }\n      }\n      const moveY = touch.deltaY.value + startY;\n      height.value = -ease(moveY);\n    };\n    const onTouchend = () => {\n      dragging.value = false;\n      height.value = closest(anchors.value, height.value);\n      if (height.value !== -startY) {\n        emit(\"heightChange\", {\n          height: height.value\n        });\n      }\n    };\n    watch(boundary, () => {\n      height.value = closest(anchors.value, height.value);\n    }, {\n      immediate: true\n    });\n    useLockScroll(rootRef, () => props.lockScroll);\n    useEventListener(\"touchmove\", onTouchmove, {\n      target: rootRef\n    });\n    return () => {\n      var _a;\n      return _createVNode(\"div\", {\n        \"class\": [bem(), {\n          \"van-safe-area-bottom\": props.safeAreaInsetBottom\n        }],\n        \"ref\": rootRef,\n        \"style\": rootStyle.value,\n        \"onTouchstartPassive\": onTouchstart,\n        \"onTouchend\": onTouchend,\n        \"onTouchcancel\": onTouchend\n      }, [_createVNode(\"div\", {\n        \"class\": bem(\"header\")\n      }, [_createVNode(\"div\", {\n        \"class\": bem(\"header-bar\")\n      }, null)]), _createVNode(\"div\", {\n        \"class\": bem(\"content\"),\n        \"ref\": contentRef\n      }, [(_a = slots.default) == null ? void 0 : _a.call(slots)])]);\n    };\n  }\n});\nexport {\n  stdin_default as default,\n  floatingPanelProps\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}